{% extends "base.html" %}
{% block content %}
  <div class="card">
    <p>{{ domain_desc }}</p>
    <p>В проекте намеренно реализованы три уязвимости эскалации привилегий.</p>
  </div>

  <h3>Ссылки</h3>
  <ul>{% for url, label in actions %}<li><a href="{{ url }}">{{ label }}</a></li>{% endfor %}</ul>

  <h3>Мои объекты</h3>
  <ul>{% for url, label in my_lists %}<li><a href="{{ url }}">{{ label }}</a></li>{% endfor %}</ul>

  <div class="card">
    <strong>Плохая проверка на клиенте:</strong>
    <p>Кнопки ниже появляются, если <code>localStorage.isAdmin</code> равен <code>"true"</code>.</p>
    {%if user.is_superuser%}
    <button id="openAdminBtn" onclick="location.href='/vuln/admin_panel/'">Открыть уязвимую админ-панель</button>
    <form id="promoteForm" method="get" action="/vuln/promote_user/2/">
      <input type="text" name="role" value="admin"><button type="submit">Повысить пользователя #2 до admin (уязвимо)</button>
    </form>
    {%endif%}
  </div>
  <script>
{% endblock %}
